---
title: Sp00kyCTF 2022 Reflection
date: 2022-11-01 8:00:00 +/-1111
author: David Wolfe
categories: [Writeups, sp00kyCTF]
tags: [ctf,writeup,sp00ky,ISU] 
---
## Intro
Sp00kyCTF 2022 finished up the other weekend and it was a blast! I hope everyone had fun and learned at least one new technique or tool. This year around I was repsonsible for creating a lot more challenges compared to last year. Specifically I wanted to make sure we had a good variety of easy and difficult Web App challenges. This blog post will serve as a writeup for all of the challenges I did and a mini-debrief for anybody who didn't catch the info at the end of the event.

## Challenges

### Web01: WEB 3.WOAH
This challenge was ment to be the easiest web challenge I created. However, nobody ended up solving it during the event and in retrospect I could have out more hints in the application for this challenge. The description of this challenge pointed users to a simple webpage with one field for user input.

![Web01 Starting Page](/images/sp00ky22/web01-1.png)

The text on this page made it clear that it was loading webpages by the file path instead of going through proper routing middlewear. This should immediately peak a hackers interest and cause them to start thinking about [LFI (local file inclusion)](https://www.geeksforgeeks.org/local-file-inclusion-lfi/). The only issue with LFI in this case is that nothing on this first page says exactly where the flag is. Without that information we would just be trying endless possible locations trying to find the flag. 

The solution to this issue is hidden in the source of the challenges home page. Using inspect element on a browser the user is able to see a commented out html line that reviewls the flag is located at `/flag.txt`.

![Web01 Source Code Hint](/images/sp00ky22/web01-hint.png)

The next logical step for a user would be to enter `/flag.txt` into the load field box to try and get the flag. If this is submitted to the webserver the results are shown below.

![Web01 Source Code Hint](/images/sp00ky22/web01-slash.png)

This error message is a hint to the user that `/` is a filtered character when it is placed at the front of the request. With this info, I expected users to begin thinking about common [directory traversal](https://brightsec.com/blog/directory-traversal-attack/) attack technqiues. The most common type of directory traversal involves adding a large number of `../`'s before the file you want to load to escape the current directory and get to the root of the file system. Submitting a query like `../../../../../flag.txt` to the server results in this.

![Web01 Source Code Hint](/images/sp00ky22/web01-dotdot.png)

The message provided with this entry hints that maybe `../` is being replaced with an empty string before loading the file. This theory can be tested by sending `.../flag.txt` and seeing that the resulting file that was searched for becomes `.flag.txt` confirming that `../` is being removed. This is the final piece of information needed to solve this challenge. The payload `....//` when placed through the replacement filter described above would resolve to `../` after the middle `../` is removed and the outside characters are pushed togther. `..|../|/` -> `../`. 

Sending the request `....//....//....//....//....//....//flag.txt` gets the flag.

![Web01 Source Code Hint](/images/sp00ky22/web01-flag.png)
```
sp00ky{I_r3a11y_th0ught_th15_wa5_security:'-(}
```

### Web02: SQLi #1

